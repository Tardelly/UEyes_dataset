/*
 * heatmap.js v2.0.5 | JavaScript Heatmap Library
 *
 * Copyright 2008-2016 Patrick Wied <heatmapjs@patrick-wied.at> - All rights reserved.
 * Dual licensed under MIT and Beerware license 
 *
 * :: Beerware License
 * As long as you retain this notice you can do whatever you want with this stuff.
 * If we meet some day, and you think this stuff is worth it, you can buy me a 
 * beer in return.
 */
(function(a,b,c){if(typeof module!=="undefined"&&module.exports){module.exports=c()}else if(typeof define==="function"&&define.amd){define(c)}else{b[a]=c()}})("h337",this,function(){var a={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:.6,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}};var b=function h(){var b=function d(a){this._coordinator=a;this._data=[];this._radi=null};var c=a.defaultRadius;b.prototype={_organiseData:function(a,b){var d=a[this._coordinator.getXField()];var e=a[this._coordinator.getYField()];var f=a[this._coordinator.getValueField()];var g=this._radi;if(!g){g=this._radi=[]}if(!g[d]){g[d]=[]}if(!g[d][e]){g[d][e]=f}else{g[d][e]+=f}if(!this._data[d]){this._data[d]=[]}if(!this._data[d][e]){this._data[d][e]=a}else{this._data[d][e].value+=a.value}return b},_unOrganiseData:function(){var a=[];var b=this._data;for(var c in b){for(var d in b[c]){a.push(b[c][d])}}return{min:0,max:1,data:a}},_onExtremaChange:function(){this._radi=null},addData:function(){if(arguments[0].length>0){var a=arguments[0];var b=a.length;while(b--){this.addData(a[b])}}else{var c=this._organiseData(arguments[0],true)}return this},setData:function(a){var b=a.data;var c=a.max;var d=a.min;this._coordinator.setExtrema(d,c);this._data=b;this._organiseData(b,false);this._onExtremaChange();return this},removeData:function(){},setDataMax:function(a){this._coordinator.setExtrema(this._coordinator.getMin(),a);this._onExtremaChange();return this},setDataMin:function(a){this._coordinator.setExtrema(a,this._coordinator.getMax());this._onExtremaChange();return this},setCoordinator:function(a){this._coordinator=a},_getInternalData:function(){return{max:this._coordinator.getMax(),min:this._coordinator.getMin(),data:this._data,radi:this._radi}},getData:function(){return this._unOrganiseData()}};return b}();var c=function i(){var a=function(a){this.config=a;this.renderer=new this.config.renderer(a);this.store=new this.config.store(this)};return a}();c.prototype={addData:function(){this.store.addData.apply(this.store,arguments);this.renderer.renderPartial(this.store._getInternalData());return this},removeData:function(){this.store.removeData.apply(this.store,arguments);this.renderer.renderPartial(this.store._getInternalData());return this},setData:function(){this.store.setData.apply(this.store,arguments);this.renderer.renderAll(this.store._getInternalData());return this},setDataMax:function(){this.store.setDataMax.apply(this.store,arguments);this.renderer.renderAll(this.store._getInternalData());return this},setDataMin:function(){this.store.setDataMin.apply(this.store,arguments);this.renderer.renderAll(this.store._getInternalData());return this},configure:function(a){this.config=e(this.config,a);this.renderer.updateConfig(this.config);this.renderer.setDimensions(a.width,a.height);this.renderer.renderAll(this.store._getInternalData());return this},repaint:function(){this.renderer.renderAll(this.store._getInternalData());return this},getData:function(){return this.store.getData()},getDataURL:function(){return this.renderer.getDataURL()},getCanvas:function(){return this.renderer.getCanvas()}};var d=function j(){var a=false;var b=[].slice.call(arguments);if(a){return}var c=function(a,b){this._canvas=a;this._width=a.width;this._height=a.height;this._shadowCanvas=this._getShadowCanvas();this._templates={};this.initColorPalette(b)};c.prototype={render:function(a,b){this._clear();this._renderSources(a,b);return this},renderPartial:function(a){this._renderSources(a);return this},initColorPalette:function(b){var c=b.gradient||b.defaultGradient;var d=document.createElement("canvas");var e=d.getContext("2d");d.width=256;d.height=1;var f=e.createLinearGradient(0,0,256,1);for(var g in c){f.addColorStop(g,c[g])}e.fillStyle=f;e.fillRect(0,0,256,1);this._palette=e.getImageData(0,0,256,1).data;delete b.gradient},getWidth:function(){return this._width},getHeight:function(){return this._height},_getShadowCanvas:function(){var a=document.createElement("canvas");a.width=this._width;a.height=this._height;return a},_clear:function(){this._canvas.getContext("2d").clearRect(0,0,this._width,this._height)},_renderSources:function(a){var b=this._shadowCanvas.getContext("2d");var c=this._palette;var d=a;var e=a.length;b.clearRect(0,0,this._width,this._height);while(e--){var f=d[e];var g=f.x;var h=f.y;var i=f.radius;var j=f.value;var k=i*2;var l;if(this._templates[k]){l=this._templates[k]}else{l=this._templates[k]=this._getPointTemplate(i)}var m=this._mergeAlpha(j);b.globalAlpha=m;b.drawImage(l,g-i,h-i)}var n=this._shadowCanvas.getContext("2d").getImageData(0,0,this._width,this._height);this._colorize(n.data,c);this._canvas.getContext("2d").putImageData(n,0,0)},_getPointTemplate:function(a){var b=document.createElement("canvas");var c=b.getContext("2d");var d=a;var e=a;b.width=b.height=d*2;c.beginPath();c.arc(d,e,a,0,2*Math.PI,false);c.fillStyle="rgba(0,0,0,1)";c.fill();return b},_mergeAlpha:function(a){var b=.05;return a>1?b:a<0?0:a*b},_colorize:function(a,b){for(var c=3,d=a.length,e;c<d;c+=4){e=a[c]*4;if(e){a[c-3]=b[e];a[c-2]=b[e+1];a[c-1]=b[e+2]}}}};return c}();var e=function k(){var a={};var b=[].slice.call(arguments);for(var c=0;c<b.length;c++){var d=b[c];for(var e in d){a[e]=d[e]}}return a};var f=function l(){var b=function(a){this._config=a;if(a.container){var b=this.getContainer();this._config.width=this._config.width||b.offsetWidth;this._config.height=this._config.height||b.offsetHeight}this._renderer=new d(this._config);this._canvas=this._renderer.getCanvas();this._data=null};b.prototype={getContainer:function(){return this._config.container},getCanvas:function(){return this._canvas},getDataURL:function(){return this._canvas.toDataURL()},updateConfig:function(a){this._config=e(this._config,a);this._renderer.initColorPalette(this._config)},setDimensions:function(a,b){this._canvas.width=a;this._canvas.height=b;this._renderer._width=a;this._renderer._height=b},renderAll:function(a){this._data=a;this._renderer.render(this._data.data,this._config.valueField)},renderPartial:function(a){this._data=a;this._renderer.renderPartial(this._data.data,this._config.valueField)}};return b}();var g={create:function(b){var d={};var g=e(a,b);var h=new f(g);d.get("container").appendChild(h.getCanvas());d.store=h;d.config=g;d=e(d,c.prototype);return d},register:function(b,c){a.plugins[b]=c}};return g});